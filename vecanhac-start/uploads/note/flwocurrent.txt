DÆ°á»›i Ä‘Ã¢y lÃ  báº£n tá»•ng há»£p Ä‘áº§y Ä‘á»§ nhá»¯ng gÃ¬ báº¡n Ä‘Ã£ triá»ƒn khai cho há»‡ thá»‘ng vecanhac.com, cáº£ backend (Spring Boot DDD) láº«n frontend (Next.js) â€” Ä‘Æ°á»£c chia theo tá»«ng pháº§n chá»©c nÄƒng, Ä‘Ãºng vá»›i tiáº¿n Ä‘á»™ báº¡n Ä‘Ã£ thá»±c hiá»‡n.

ğŸ§± I. Backend (Spring Boot - DDD Architecture)
ğŸ“ 1. Kiáº¿n trÃºc module
vecanhac-domain: chá»©a entity, repository, enum, domain logic

vecanhac-application: chá»©a DTOs, services, mapper, flow nghiá»‡p vá»¥

vecanhac-controller: REST controllers

vecanhac-infrastructure: Redis, JWT, Security, Mail, Scheduler

vecanhac-start: main entry point

ğŸ« 2. Há»‡ thá»‘ng Ä‘áº·t vÃ©
âœ… Chá»n vÃ© â†’ Ä‘iá»n thÃ´ng tin â†’ thanh toÃ¡n

âœ… TÃ­nh tá»•ng tiá»n, Ã¡p mÃ£ giáº£m giÃ¡ (code Ä‘Ã£ kiá»ƒm tra eventId, minQuantity, usageLimit, expired)

âœ… Sinh QR code, táº¡o Order + OrderItem

âš ï¸ CÃ³ logic tÃ­nh discountAmount nhÆ°ng chÆ°a cÃ³ Redis lock

âš ï¸ ÄÆ¡n chÆ°a thanh toÃ¡n váº«n tá»“n táº¡i (chÆ°a cÃ³ timeout 15 phÃºt)

âœ… DÃ¹ng @Transactional Ä‘á»ƒ Ä‘áº£m báº£o atomic

ğŸ” 3. XÃ¡c thá»±c & phÃ¢n quyá»n
âœ… ÄÄƒng kÃ½ qua email OTP (vá»›i báº£ng users cÃ³ is_verified)

âœ… ÄÄƒng nháº­p â†’ sinh JWT â†’ lÆ°u vÃ o cookie

âœ… PhÃ¢n quyá»n USER, ORG, ADMIN

âœ… DÃ¹ng @PreAuthorize("hasRole('ADMIN')") cho admin

ğŸ‘¥ 4. NgÆ°á»i dÃ¹ng
âœ… Táº¡o user

âœ… NÃ¢ng cáº¥p role tá»« USER â†’ ORG

âœ… KhÃ³a user (soft lock)

âœ… Truy váº¥n danh sÃ¡ch user theo role

ğŸ“… 5. Sá»± kiá»‡n, suáº¥t chiáº¿u, vÃ©
âœ… Táº¡o sá»± kiá»‡n gá»“m Event + Showing + Ticket

âœ… TÃ¡ch flow PENDING â†’ APPROVED khi táº¡o sá»± kiá»‡n

âœ… Quáº£n lÃ½ bá»Ÿi ORG hoáº·c ADMIN

âœ… PATCH-style update (update tá»«ng pháº§n khÃ´ng xoÃ¡ toÃ n bá»™)

âœ… Chá»n Ä‘á»‹a Ä‘iá»ƒm + danh má»¥c tá»« báº£ng locations, categories

ğŸ› 6. MÃ£ giáº£m giÃ¡ (Coupons)
âœ… Táº¡o mÃ£ giáº£m giÃ¡ gáº¯n vá»›i eventId (náº¿u cÃ³)

âœ… Giá»›i háº¡n sá»‘ láº§n dÃ¹ng / ngÆ°á»i / toÃ n há»‡ thá»‘ng

âœ… Kiá»ƒm tra qua API /discounts/check

âœ… DTO DiscountRequestDTO, DiscountResponseDTO

âœ… Báº£ng discount_code_usage log lÆ°á»£t dÃ¹ng

ğŸ“Š 7. Admin dashboard
âœ… Duyá»‡t / tá»« chá»‘i sá»± kiá»‡n

âœ… Danh sÃ¡ch user

âœ… Thá»‘ng kÃª sá»‘ lÆ°á»£ng ngÆ°á»i dÃ¹ng / Ä‘Æ¡n hÃ ng / vÃ©

âœ… Doanh thu theo ngÃ y/thÃ¡ng

âš ï¸ ChÆ°a cÃ³ log hÃ nh vi admin

âš ï¸ API thá»‘ng kÃª dáº¡ng chart chÆ°a chuáº©n hÃ³a labels + data

ğŸ§  8. Redis (Ä‘ang chuáº©n bá»‹)
âš ï¸ ChÆ°a setup Redis Ä‘á»ƒ:

Lock vÃ©

Giá»¯ bookingSessionId táº¡m thá»i

Tá»± huá»· Ä‘Æ¡n chÆ°a thanh toÃ¡n

âœ… FE Ä‘Ã£ sinh bookingSessionId vÃ  truyá»n suá»‘t flow â†’ Ä‘Ã£ sáºµn sÃ ng dÃ¹ng Redis

ğŸ¨ II. Frontend (Next.js + Tailwind + Framer Motion)
ğŸŒ 1. Cáº¥u trÃºc chÃ­nh
app/: tá»«ng page tÆ°Æ¡ng á»©ng flow

components/: EventCard, Navbar, AuthModal...

lib/api/: gá»i API

âœ… TÃ¡ch cÃ¡c page: select-ticket, question-ticket, checkout-ticket, my-tickets

ğŸ« 2. Äáº·t vÃ© (booking flow UI)
â¤ SelectTicketPage:
âœ… Load event + showings + tickets

âœ… Chá»n sá»‘ lÆ°á»£ng vÃ©

âœ… Sinh bookingSessionId â†’ truyá»n qua URL

â¤ QuestionTicketPage:
âœ… Láº¥y láº¡i vÃ© tá»« URL

âœ… Giao diá»‡n nháº­p email/phone (readonly)

âœ… MÃ£ giáº£m giÃ¡: gá»­i request BE vÃ  hiá»ƒn thá»‹ message

â¤ CheckoutTicketPage:
âœ… Tá»•ng tiá»n

âœ… MÃ£ giáº£m giÃ¡ Ä‘Ã£ Ã¡p

âœ… Chá»n phÆ°Æ¡ng thá»©c thanh toÃ¡n

âœ… Gá»­i checkout lÃªn BE

âœ… Hiá»ƒn thá»‹ countdown + huá»· náº¿u háº¿t thá»i gian

ğŸ“‹ 3. MyTicketsPage
âœ… Xem danh sÃ¡ch Ä‘Æ¡n hÃ ng (Order)

âœ… Expand Ä‘á»ƒ xem danh sÃ¡ch vÃ© (OrderItem)

âœ… Hiá»ƒn thá»‹ QR code

ğŸ”’ 4. Auth / User
âœ… Modal Ä‘Äƒng nháº­p, Ä‘Äƒng kÃ½

âœ… Gá»­i OTP email

âœ… Form quÃªn máº­t kháº©u â†’ OTP â†’ táº¡o máº­t kháº©u má»›i

ğŸ›  5. Ká»¹ thuáº­t nÃ¢ng cao
âœ… bookingSessionId Ä‘Æ°á»£c truyá»n suá»‘t 3 page

âœ… localStorage Ä‘Æ°á»£c dá»n dáº¹p sau khi Ä‘áº·t vÃ© xong hoáº·c háº¿t thá»i gian

âš ï¸ ChÆ°a gá»i API lock vÃ© táº¡m thá»i (khi chá»n vÃ©)

ğŸ§¾ Tá»•ng káº¿t luá»“ng Ä‘áº·t vÃ© (booking flow full-stack)
BÆ°á»›c	FE	BE
1. Chá»n vÃ©	Giao diá»‡n chá»n vÃ©, sinh bookingSessionId	â€”
2. Báº£ng cÃ¢u há»i	Truy xuáº¥t vÃ©, Ä‘iá»n email, mÃ£ giáº£m giÃ¡	Validate, tÃ­nh discountAmount
3. Thanh toÃ¡n	Hiá»ƒn thá»‹ tá»•ng tiá»n, phÆ°Æ¡ng thá»©c thanh toÃ¡n	Táº¡o Order + OrderItem, gáº¯n bookingSessionId
4. Xem vÃ© Ä‘Ã£ mua	Trang /my-tickets	Láº¥y order theo userId, join order items

ğŸ¯ Gá»£i Ã½ viá»‡c tiáº¿p theo (náº¿u báº¡n muá»‘n nÃ¢ng cáº¥p)
Háº¡ng má»¥c	Má»¥c tiÃªu
Redis Lock + giá»¯ vÃ© táº¡m thá»i	Chá»‘ng oversell, giá»¯ vÃ© 15 phÃºt
Log admin actions	Ghi láº¡i duyá»‡t/tá»« chá»‘i/khÃ³a...
Dashboard stats chart API	Chuáº©n hÃ³a labels + data
Rate-limit + Queue (Kafka, v.v.)	Scale há»‡ thá»‘ng lá»›n
Test API load (k6 / Postman / Apache JMeter)	Äo sá»©c chá»‹u táº£i thá»±c táº¿